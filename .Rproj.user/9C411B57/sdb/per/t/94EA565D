{
    "contents" : "assess <- function(score, mean=0, sd=1, distribution=NA, language=\"en\", colour.line=\"#E91E63\", colour.fill=\"#2196F3\"){\n\n  if(length(distribution)==1){\n    distribution <- rnorm(50000, mean=mean, sd=sd)\n    given.pop <- FALSE\n    }else{given.pop <- TRUE}\n\n  df <- data.frame(\"pop\"=distribution)\n\n  plot <- ggplot(df, aes_string(\"pop\")) +\n    geom_density(fill=colour.fill, colour=\"white\", adjust = 3, na.rm=TRUE) +\n    geom_vline(xintercept=score,size = 2, color=colour.line) +\n    xlab(\"\\nScore\") +\n    ylab(\"Distribution\\n\") +\n    theme_neuropsychology()\n\n  percentile <- ecdf(distribution)\n  percentile <- percentile(score)\n\n  if(percentile<0.50){\n    percentile <- 1-percentile\n    comparison <- \"smaller\"\n  }else{comparison <- \"greater\"}\n\n\n  if(given.pop==TRUE){\n    mean <- round(mean(distribution, na.rm=TRUE),2)\n    sd <- round(sd(distribution, na.rm=TRUE),2)\n  }else{\n    mean <- mean\n    sd <- sd\n  }\n  if(language==\"fr\"){\n    if(comparison==\"smaller\"){\n      comparison <- \"inferieur\"\n    }else{comparison <- \"superieur\"}\n    print(paste(\"Le participant (score = \",\n          score,\n          \") se situe a \",\n          as.character(round((score-mean)/sd, 2)),\n          \" ecarts-types de la moyenne (M = \",\n          as.character(mean),\n          \", ecart-type = \",\n          as.character(sd),\n          \"). \",\n          \"Le score du participant est \",\n          comparison,\n          \" a \",\n          as.character((round(percentile*100, 2))),\n          \" % de la population generale.\", sep=\"\"))\n  }else{\n    print(paste(\"The participant (score = \",\n                score,\n                \") is positioned at \",\n                as.character(round((score-mean)/sd, 2)),\n                \" standard deviations from the mean (M = \",\n                as.character(mean),\n                \", SD = \",\n                as.character(sd),\n                \"). \",\n                \"The participant's score is \",\n                comparison,\n                \" than \",\n                as.character((round(percentile*100, 2))),\n                \" % of the general population.\", sep=\"\"))\n  }\nreturn(plot)\n}\n",
    "created" : 1475102123079.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3974095887",
    "id" : "94EA565D",
    "lastKnownWriteTime" : 1475102181,
    "path" : "D:/Programs/Dropbox/RECHERCHE/DOCUMENTS/R_packages/neuropsychology.R/R/assess.R",
    "project_path" : "R/assess.R",
    "properties" : {
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "type" : "r_source"
}