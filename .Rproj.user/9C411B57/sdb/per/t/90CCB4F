{
    "contents" : "cortable <- function(df, \n                     correction=\"none\", \n                     type=\"pearson\", \n                     print.result=TRUE,\n                     plot.result=TRUE){\n\n  type <- ifelse(type == \"s\", \"spearman\",\n                 ifelse(type == \"spearman\", \"spearman\",\"pearson\"))\n\n\n  for (i in names(df)){\n    if (is.numeric(df[,i]) == FALSE){\n      df[,i] = NULL\n    }\n  }\n  dimnames <- names(df)\n  df <- as.matrix(df)\n\n\n\n  R <- rcorr(df, type = type)$r\n  p <- rcorr(df, type = type)$P\n  p <- p.adjust(p, method = correction)\n  p.mat <- matrix(p, ncol = ncol(R), dimnames = list(dimnames,dimnames))\n\n  ## define notions for significance levels; spacing is important.\n  mystars <- ifelse(p < .001, \"***\", ifelse(p < .01, \"** \", ifelse(p < .05, \"* \", \" \")))\n\n  ## trunctuate the matrix that holds the correlations to two decimal\n  R <- format(round(cbind(rep(-1.11, ncol(df)), R), 2))[,-1]\n\n  ## build a new matrix that includes the correlations with their apropriate stars\n  table <- matrix(paste(R, mystars, sep=\"\"), ncol=ncol(df))\n  diag(table) <- paste(diag(R), \" \", sep=\"\")\n  rownames(table) <- colnames(df)\n  colnames(table) <- paste(colnames(df), \"\", sep=\"\")\n\n  ## remove upper triangle\n  table <- as.matrix(table)\n  table[upper.tri(table, diag = TRUE)] <- NA\n  table <- as.data.frame(table)\n\n  ## remove last column and return the matrix (which is now a data frame)\n  table <- cbind(table[1:length(table)-1])\n  \n  if (print.result==TRUE){\n    print(table)\n  }\n  if (plot.result==TRUE){\n    print(ggcorrplot(rcorr(df, type = type)$r,\n               title = paste(\"A \", type, \"'s correlation matrix (correction: \", correction, \")\", sep = \"\"),\n               method = \"circle\",\n               type=\"lower\",\n               colors=c(\"#E91E63\", \"white\", \"#03A9F4\"),\n               hc.order = TRUE,\n               p.mat = p.mat,\n               insig=\"pch\",\n               legend.title=\"\",\n               lab = FALSE))\n  }\n  \n  return(as.data.frame(table))\n}\n",
    "created" : 1472216955048.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3259950170",
    "id" : "90CCB4F",
    "lastKnownWriteTime" : 1472216811,
    "path" : "D:/Programs/Dropbox/RECHERCHE/DOCUMENTS/R_packages/neuropsychology.R/R/cortable.R",
    "project_path" : "R/cortable.R",
    "properties" : {
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "type" : "r_source"
}